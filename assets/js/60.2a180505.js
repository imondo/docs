(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{388:function(s,n,e){"use strict";e.r(n);var a=e(18),l=Object(a.a)({},(function(){var s=this,n=s.$createElement,e=s._self._c||n;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"gulp-前端自动化构建工具"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#gulp-前端自动化构建工具"}},[s._v("#")]),s._v(" gulp 前端自动化构建工具")]),s._v(" "),e("h2",{attrs:{id:"插件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#插件"}},[s._v("#")]),s._v(" 插件")]),s._v(" "),e("ul",[e("li",[s._v("gulp-babel ES6转换成ES5兼容")]),s._v(" "),e("li",[s._v("gulp-load-plugins 自动加载"),e("code",[s._v("package.json")]),s._v("中的 "),e("code",[s._v("gulp")]),s._v("插件")]),s._v(" "),e("li",[s._v("gulp-plumber 一个专门为gulp而生的错误处理库。")]),s._v(" "),e("li",[s._v("gulp-htmlmin 看到名字就能知道，这个插件是用来压缩 HTML。PS：注释啥的都可以去掉哦，看文档get更多技能哈")]),s._v(" "),e("li",[s._v("gulp-imagemin 除了能压缩常见的图片格式，还能压缩 SVG，叼叼的~")]),s._v(" "),e("li",[s._v("gulp-clean-css 压缩 CSS。我原本推荐的是 gulp-minify-css，结果其首页中已建议改用gulp-clean-css...")]),s._v(" "),e("li",[s._v("gulp-uglify 专业压缩 Javascript")]),s._v(" "),e("li",[s._v("gulp-concat 上面几个都是压缩，这插件是管合并的...恭喜，“减少网络请求”的成就达成:)")]),s._v(" "),e("li",[s._v("gulp-autoprefixer 给 CSS 增加前缀。解决某些CSS属性不是标准属性，有各种浏览器前缀的情况，灰常有用")]),s._v(" "),e("li",[s._v("gulp-rename 修改文件名称。比如有时我们需要把app.js改成app.min.js，瞬间高级了")]),s._v(" "),e("li",[s._v("gulp-util 最基础的工具，但俺只用来打日志...")]),s._v(" "),e("li",[s._v("run-sequence 任务按自己顺序执行")]),s._v(" "),e("li",[s._v("del / gulp-clean 删除。俺的使用场景是：JS/CSS 文件都会在压缩后使用gulp-rev，即文件名被hash，然后再上传到 CDN，最后使用 "),e("code",[s._v("删除插件")]),s._v(" 把本地压缩后的文件删除。")]),s._v(" "),e("li",[s._v("gulp-rev 把静态文件名改成hash的形式。")]),s._v(" "),e("li",[s._v("gulp-rev-replace 配合 gulp-rev 使用，拿到生成的 "),e("code",[s._v("manifest.json")]),s._v(" 后替换对应的文件名称。")]),s._v(" "),e("li",[s._v("gulp-rev-collector 到线上环境前，我会用来配合gulp-rev使用，替换 HTML 中的路径")]),s._v(" "),e("li",[s._v("gulp-connect / gulp-livereload LiveReload 的俩款插件都值得拥有，不过都各稍有学习成本，看看文档就明白鸟")]),s._v(" "),e("li",[s._v("gulp-sass / gulp-less")])]),s._v(" "),e("h2",{attrs:{id:"运行"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#运行"}},[s._v("#")]),s._v(" 运行")]),s._v(" "),e("p",[s._v("先建立 "),e("code",[s._v("package.json")]),s._v("，在项目根目录下建立 "),e("code",[s._v("gulpfile.js")]),s._v("文件")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("const gulp = require('gulp');\n\ngulp.task('dev', () => {\n  // 任务处理逻辑\n});\n\ngulp.task('default', ['dev']);\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h2",{attrs:{id:"编译es6"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#编译es6"}},[s._v("#")]),s._v(" 编译ES6")]),s._v(" "),e("ul",[e("li",[s._v("安装babel")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("npm install babel-core@7.0.0 gulp-babel babel-preset-es2015 --save-dev\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("配置")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("const gulp = require('gulp');\nconst $ = require('gulp-load-plugins')();  \n\n/* es6 */  \ngulp.task('es6', function() {    \n  return gulp.src('src/**/*.js')  \n    .pipe($.plumber())\n    .pipe($.babel({  \n      presets: ['es2015']  \n    }))  \n    .pipe(gulp.dest('dist/'));  \n}); \n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("h2",{attrs:{id:"版本号处理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#版本号处理"}},[s._v("#")]),s._v(" 版本号处理")]),s._v(" "),e("p",[s._v("由于浏览器缓存原因，每次部署可能对于用户来说，程序上线后并没有实时看到程序当前版本响应。")]),s._v(" "),e("p",[s._v("实现方式有两种，第一种，利用"),e("code",[s._v("gulp-rev")]),s._v("和"),e("code",[s._v("gulp-rev-collector")]),s._v(":")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("const gulp = require('gulp);\nconst rev = require('gulp-rev');\nconst revCollector = require('gulp-rev-collector');\nconst runSequence = require('run-sequence');\nconst $ = require('gulp-load-plugins')();\n\ngulp.task('build', () => {\n  return gulp.src('dist/src/js', {base: 'js'})\n    .pipe($.plumber())\n    .pipe($.babel({\n      presets: ['es2015']\n    }))\n    .pipe(gulp.dest('dist'));\n})\n\ngulp.task('revJs', () => {\n  return gulp.src('dist/js/pack/**/**/*.js')\n    .pipe(rev())\n    .pipe(gulp.dest('dist/js'))\n    .pipe(rev.manifest())\n    .pipe($.rename('js-manifest.json'))\n    .pipe(gulp.dest('dist/rev'));\n})\n\ngulp.task('rev', function () {\n  log('替换开始');\n  return gulp.src([output + '/*.json', distPath + '/**/**/*.html'])\n  .pipe(revCollector({\n      replaceReved: true\n  }))\n  .pipe(gulp.dest(distPath));\n});\n\ngulp.task('clean:pack', (cb) => {\n  log('clean pack')\n  del([\n    output + '/css/pack',\n    output + '/js/pack',\n    output + '/rev'\n  ], cb);\n})\n\ngulp.task('pack', () => {\n  // 先清理，再进行生成\n  del(distFolder + '/**/*', {force: true}).then(() => {\n    log('已清理发布文件夹：' + distFolder);\n\n    // 执行生成\n    runSequence('build', ['revJs'], 'rev', 'clean:pack',function() {\n      log('任务完成');\n    });\n  });\n});\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br")])]),e("p",[s._v("第二种，利用"),e("code",[s._v("gulp-rev")]),s._v("，"),e("code",[s._v("gulp-replace")]),s._v("，"),e("code",[s._v("gulp-rev-replace")]),s._v("，"),e("code",[s._v("gulp-rev-format")]),s._v("插件来替换。")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("const gulp = require('gulp);\nconst $ = require('gulp-load-plugins')();\n\ngulp.task('build', () => {\n  return gulp.src('dist/src/js', {base: 'js'})\n    .pipe($.plumber())\n    .pipe($.babel({\n      presets: ['es2015']\n    }))\n    .pipe(gulp.dest('dist'));\n})\n\ngulp.task('revJs', () => {\n  return gulp.src('dist/js/**/**/*.js')\n    .pipe(rev())\n    .pipe(revFormat({\n      prefix: '.', // 在版本号前增加字符\n      suffix: '.cache', // 在版本号后增加字符\n      lastExt: false\n    }))\n    .pipe(rev.manifest())\n    .pipe($.rename('js-manifest.json'))\n    .pipe(gulp.dest('dist/rev'));\n})\n\nfunction compRev(output) {  \n  log('替换开始');\n  var manifest = gulp.src([output + \"/rev/*.json\"]);\n  var nowDate = new Date().getTime();\n  function modifyUnreved(filename) {\n    return filename;\n  }\n  function modifyReved(filename) {    \n    if (filename.indexOf('.cache') > -1) {\n      const _version = filename.match(/\\.[\\w]*\\.cache/)[0].replace(/(\\.|cache)*/g,\"\");\n      const _filename = filename.replace(/\\.[\\w]*\\.cache/,\"\");\n      filename = _filename + \"?v=\" + nowDate + '-' + _version;\n      return filename;\n    }\n    return filename;\n  }\n  return gulp.src([output + '/**/**.html']) \n    .pipe($.replace(/(\\.[a-z]+)\\?(v=)?[^\\'\\\"\\&]*/g,\"$1\")) \n    .pipe($.revReplace({\n      manifest: manifest,\n      modifyUnreved: modifyUnreved,\n      modifyReved: modifyReved\n    }))  \n    .pipe(gulp.dest(output));\n}\n\ngulp.task('rev', function () {\n  return compRev('dist');\n});\n\ngulp.task('clean:pack', (cb) => {\n  log('clean pack')\n  del([\n    output + '/css/pack',\n    output + '/js/pack',\n    output + '/rev'\n  ], cb);\n})\n\ngulp.task('pack', () => {\n  // 先清理，再进行生成\n  del(distFolder + '/**/*', {force: true}).then(() => {\n    log('已清理发布文件夹：' + distFolder);\n\n    // 执行生成\n    runSequence('build', ['revJs'], 'rev', 'clean:pack',function() {\n      log('任务完成');\n    });\n  });\n});\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br"),e("span",{staticClass:"line-number"},[s._v("73")]),e("br"),e("span",{staticClass:"line-number"},[s._v("74")]),e("br"),e("span",{staticClass:"line-number"},[s._v("75")]),e("br"),e("span",{staticClass:"line-number"},[s._v("76")]),e("br")])])])}),[],!1,null,null,null);n.default=l.exports}}]);