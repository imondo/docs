(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{378:function(s,t,a){"use strict";a.r(t);var n=a(18),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"javascript线程机制与事件机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#javascript线程机制与事件机制"}},[s._v("#")]),s._v(" JavaScript线程机制与事件机制")]),s._v(" "),a("h2",{attrs:{id:"线程与进程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#线程与进程"}},[s._v("#")]),s._v(" 线程与进程")]),s._v(" "),a("ul",[a("li",[s._v("进程\n"),a("ul",[a("li",[s._v("程序的一次执行，它占有一片独有的内存空间")]),s._v(" "),a("li",[s._v("可以通过 "),a("code",[s._v("window")]),s._v(" 任务管理器查看进程")])])]),s._v(" "),a("li",[s._v("线程\n"),a("ul",[a("li",[s._v("是进程内的一个独立执行单元")]),s._v(" "),a("li",[s._v("是程序执行的一个完整流程")]),s._v(" "),a("li",[s._v("是CPU的最小的调度单元")])])]),s._v(" "),a("li",[s._v("关系\n"),a("ul",[a("li",[s._v("一个进程至少有一个线程（主）")]),s._v(" "),a("li",[s._v("程序是在某个进程中的某个线程执行的")])])])]),s._v(" "),a("h2",{attrs:{id:"浏览器内核模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#浏览器内核模块"}},[s._v("#")]),s._v(" 浏览器内核模块")]),s._v(" "),a("ul",[a("li",[s._v("主线程\n"),a("ul",[a("li",[a("code",[s._v("js")]),s._v(" 引擎模块：负责js程序的编译与运行")]),s._v(" "),a("li",[s._v("html,css文档解析模块：负责页面文本的解析")]),s._v(" "),a("li",[s._v("DOM/CSS模块：负责dom/css在内存中的相关处理")]),s._v(" "),a("li",[s._v("布局和渲染模块：负责页面的布局和效果的绘制（内存中的对象）")])])]),s._v(" "),a("li",[s._v("分线程\n"),a("ul",[a("li",[s._v("定时器模块：负责定时器的管理")]),s._v(" "),a("li",[s._v("DOM事件响应模块：负责事件的管理")]),s._v(" "),a("li",[s._v("网络请求模块：负责Ajax请求")])])])]),s._v(" "),a("h2",{attrs:{id:"js线程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#js线程"}},[s._v("#")]),s._v(" js线程")]),s._v(" "),a("ul",[a("li",[s._v("js是单线程执行的（回调函数在主线程）")]),s._v(" "),a("li",[s._v("h5提出了实现多线程的方案：Web Workers")]),s._v(" "),a("li",[s._v("只能是主线程更新界面")])]),s._v(" "),a("h2",{attrs:{id:"定时器问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#定时器问题"}},[s._v("#")]),s._v(" 定时器问题")]),s._v(" "),a("ul",[a("li",[s._v("定时器并不是完全定时")]),s._v(" "),a("li",[s._v("如果在主线程执行了一个长时间的操作，可能导致延时才处理")])]),s._v(" "),a("h2",{attrs:{id:"事件处理机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#事件处理机制"}},[s._v("#")]),s._v(" 事件处理机制")]),s._v(" "),a("ul",[a("li",[s._v("代码分类\n"),a("ul",[a("li",[s._v("初始化执行代码：包含绑定dom事件监听，设置定时器，发送 "),a("code",[s._v("ajax")]),s._v(" 请求的代码")]),s._v(" "),a("li",[s._v("回调执行代码：处理回调逻辑")])])]),s._v(" "),a("li",[s._v("js引擎执行代码的基本流程\n"),a("ul",[a("li",[s._v("初始话代码 ==> 回调代码")]),s._v(" "),a("li",[s._v("先执行初始化代码：包含一些特别的代码回调函数（异步执行）\n"),a("ul",[a("li",[s._v("设置定时器")]),s._v(" "),a("li",[s._v("绑定事件监听")]),s._v(" "),a("li",[s._v("发送 "),a("code",[s._v("ajax")]),s._v(" 请求")])])]),s._v(" "),a("li",[s._v("后面在某个时刻才会执行回调代码")])])]),s._v(" "),a("li",[s._v("模块的2个重要组成部分\n"),a("ul",[a("li",[s._v("事件管理模块")]),s._v(" "),a("li",[s._v("回调队列")])])]),s._v(" "),a("li",[s._v("模块的运转流程\n"),a("ul",[a("li",[s._v("执行初始化代码，将事件回调函数交给对应的模块管理")]),s._v(" "),a("li",[s._v("当事件发生时，管理模块会将回调函数及其数据添加到回调队列中")]),s._v(" "),a("li",[s._v("只有当初始化代码执行完后（可能要一定时间），才会遍历读取回调队列中的回调函数执行")])])])]),s._v(" "),a("h2",{attrs:{id:"web-workers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#web-workers"}},[s._v("#")]),s._v(" Web Workers")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 可以让js在分线程执行")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// main.js")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" worker "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Worker")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'worker.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nworker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("onMessage")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("event")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 主线程接收分线程发送过来的数据")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nworker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("postMessage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 向分线程发送数据")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// worker.js")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("onmessage")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("event")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 接口主线程发送数据")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 向主线程发送数据")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("postMessage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reslut"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("blockquote",[a("p",[s._v("缺点")])]),s._v(" "),a("ul",[a("li",[a("code",[s._v("worker")]),s._v(" 内代码不能操作 "),a("code",[s._v("DOM")]),s._v(" 更新视图")]),s._v(" "),a("li",[s._v("浏览器兼容问题")]),s._v(" "),a("li",[s._v("不能跨域加载 "),a("code",[s._v("Js")])])])])}),[],!1,null,null,null);t.default=e.exports}}]);