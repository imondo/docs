(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{254:function(t,a,s){"use strict";s.r(a);var n=s(0),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"nuxt项目从开始到部署"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nuxt项目从开始到部署"}},[t._v("#")]),t._v(" Nuxt项目从开始到部署")]),t._v(" "),s("p",[t._v("前期接了个私人项目，做个官网，想到在公司都是使用"),s("code",[t._v("vue")]),t._v("技术栈，而官网刚好可以使用"),s("a",{attrs:{href:"https://zh.nuxtjs.org/guide/installation",target:"_blank",rel:"noopener noreferrer"}},[t._v("nuxt"),s("OutboundLink")],1),t._v("来做。")]),t._v(" "),s("h1",{attrs:{id:"开始"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#开始"}},[t._v("#")]),t._v(" 开始")]),t._v(" "),s("h2",{attrs:{id:"安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[t._v("#")]),t._v(" 安装")]),t._v(" "),s("p",[s("code",[t._v("nuxt")]),t._v("安装可以按照官网的步骤来")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("// 默认安装 create-nuxt-app\nyarn create nuxt-app <project-name>\ncd <project-name>\nyarn dev\n")])])]),s("h2",{attrs:{id:"使用预处理器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用预处理器"}},[t._v("#")]),t._v(" 使用预处理器")]),t._v(" "),s("p",[t._v("项目下直接安装对应的预处理器")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("yarn add less less-loader\n")])])]),s("h2",{attrs:{id:"全局组件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#全局组件"}},[t._v("#")]),t._v(" 全局组件")]),t._v(" "),s("p",[t._v("在"),s("code",[t._v("plugins")]),t._v("文件夹下创建"),s("code",[t._v("lib-components.js")]),t._v("文件")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("import Vue from 'vue';\n\nimport LoadImage from \"../components/LoadImage\";\n\nconst components = { LoadImage };\n\nObject.entries(components).forEach(([name, component]) => {\n  Vue.component(name, component)\n});\n")])])]),s("p",[t._v("在"),s("code",[t._v("nuxt.config.js")]),t._v("文件中配置")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("...\n  plugins: [\n    ...\n    '@/plugins/lib-components'\n  ],\n  ...\n")])])]),s("h2",{attrs:{id:"挂载全局http请求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#挂载全局http请求"}},[t._v("#")]),t._v(" 挂载全局http请求")]),t._v(" "),s("p",[t._v("如果我们想在全局来做请求，在传统的"),s("code",[t._v("vue")]),t._v("项目中，我们可以在"),s("code",[t._v("main.js")]),t._v("中挂载到原型上，而在"),s("code",[t._v("nuxt")]),t._v("项目上还是通过"),s("code",[t._v("plugins")]),t._v("目录。")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("// 在plugins目录中建立request.js\n// axios 配置可自定义\nVue.use({\n  install: function(Vue) {\n    Vue.prototype.$http = http;\n  }\n});\n")])])]),s("p",[t._v("在"),s("code",[t._v("nuxt.config.js")]),t._v("文件中配置")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("...\n  plugins: [\n    ...\n    '@/plugins/request'\n  ],\n  ...\n")])])]),s("p",[t._v("其他的配置与问题其实都可以在"),s("a",{attrs:{href:"https://zh.nuxtjs.org/faq",target:"_blank",rel:"noopener noreferrer"}},[t._v("官网"),s("OutboundLink")],1),t._v("中查到，语法与"),s("code",[t._v("vue")]),t._v("完全无缝对接。")]),t._v(" "),s("h1",{attrs:{id:"部署"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#部署"}},[t._v("#")]),t._v(" 部署")]),t._v(" "),s("p",[t._v("项目编写完成后要部署到线上，因为这个项目还是一个前后端分离的项目，且前端还是使用"),s("code",[t._v("nginx")]),t._v("来做代理。")]),t._v(" "),s("h2",{attrs:{id:"安装node"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装node"}},[t._v("#")]),t._v(" 安装node")]),t._v(" "),s("p",[t._v("服务器使用的是"),s("code",[t._v("centos")]),t._v("系统，可以使用"),s("code",[t._v("yum")]),t._v("安装")]),t._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[t._v("curl "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("sL "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("https")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("rpm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nodesource"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("setup_10"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("x "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" bash "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("\n\nyum install "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("y nodejs\n\nnode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("v\n")])])]),s("h2",{attrs:{id:"拷贝文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#拷贝文件"}},[t._v("#")]),t._v(" 拷贝文件")]),t._v(" "),s("ul",[s("li",[t._v("先本地执行 "),s("code",[t._v("yarn build")]),t._v("命令")]),t._v(" "),s("li",[t._v("拷贝下面标记的文件至服务器部署目录"),s("code",[t._v("/opt/deploy/front")])])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/9/11/16d1e457fb8c635f?w=267&h=509&f=png&s=16116",alt:""}})]),t._v(" "),s("p",[t._v("进入目录执行")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("cd /opt/deploy/front\n\nnpm install -production\n\nnpm run start\n")])])]),s("h2",{attrs:{id:"nginx配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nginx配置"}},[t._v("#")]),t._v(" nginx配置")]),t._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v(" www"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("test"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("opt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("deploy"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("front"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 前端文件目录")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("启动"),s("code",[t._v("nginx")]),t._v("后可以访问域名看到项目。")]),t._v(" "),s("h2",{attrs:{id:"pm2守护进程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pm2守护进程"}},[t._v("#")]),t._v(" pm2守护进程")]),t._v(" "),s("p",[t._v("对于线上项目，如果直接通过 "),s("code",[t._v("node app")]),t._v("来启动，如果报错了可能直接停止导致整个服务崩溃，我们可以使用"),s("code",[t._v("pm2")]),t._v("对"),s("code",[t._v("node")]),t._v("进程管理")]),t._v(" "),s("ul",[s("li",[t._v("安装")])]),t._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[t._v("npm install pm2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("g\n")])])]),s("ul",[s("li",[t._v("项目根目录创建"),s("code",[t._v("pm2.json")])])]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"demo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"script"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"npm run start"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"env_dev"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"NODE_ENV"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"development"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"env_production"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"NODE_ENV"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"production"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),s("ul",[s("li",[t._v("启动"),s("code",[t._v("pm2")])])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("cd /opt/deploy/front\n\npm2 start pm2.json\n")])])]),s("p",[s("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/9/20/16d4d97a605d4973?w=814&h=77&f=png&s=6230",alt:""}})]),t._v(" "),s("ul",[s("li",[t._v("常用"),s("code",[t._v("pm2")]),t._v("指令")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('pm2 start app.js               # 启动app.js应用程序\n\npm2 start app.js --name="demo"  # 启动应用程序并命名为 "demo"\n\npm2 start app.js --watch       # 当文件变化时自动重启应用\n\npm2 start script.sh            # 启动 bash 脚本\n\npm2 list                       # 列表 PM2 启动的所有的应用程序\n\npm2 show [app-name]            # 显示应用程序的所有信息\n\npm2 logs                       # 显示所有应用程序的日志\n\npm2 logs [app-name]            # 显示指定应用程序的日志\n\npm2 stop all                   # 停止所有的应用程序\n\npm2 stop 0                     # 停止 id为 0的指定应用程序\n\npm2 restart all                # 重启所有应用\n\npm2 restart 0                  # 重启id为0 的应用程序\n\npm2 delete all                 # 关闭并删除所有应用\n\npm2 delete 0                   # 删除指定应用 id 0\n\npm2 startup                    # 创建开机自启动命令\n\npm2 save                       # 保存当前应用列表\n')])])]),s("h1",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),s("p",[t._v("整个项目从开始安装到部署上线还是很平滑的，毕竟都是使用的"),s("code",[t._v("vue")]),t._v("技术栈；但是还是有可以优化的空间，该项目不是一个完整的"),s("code",[t._v("ssr")]),t._v("项目，没有很好的运用"),s("code",[t._v("nuxt")]),t._v("特性。")])])}),[],!1,null,null,null);a.default=e.exports}}]);