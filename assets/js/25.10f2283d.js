(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{383:function(s,e,a){"use strict";a.r(e);var t=a(23),n=Object(t.a)({},(function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"【vue项目总结】基于饿了么组件封装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#【vue项目总结】基于饿了么组件封装"}},[s._v("#")]),s._v(" 【Vue项目总结】基于饿了么组件封装")]),s._v(" "),a("p",[a("code",[s._v("vue")]),s._v("项目中，组件是项目的基石，每个页面都是组件来组装起来，我司没有自己的组件库，选用的是"),a("code",[s._v("ElementUI")]),s._v("组件库，在它的基础上再次封装。")]),s._v(" "),a("h2",{attrs:{id:"可编辑表格"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#可编辑表格"}},[s._v("#")]),s._v(" 可编辑表格")]),s._v(" "),a("p",[s._v("由于是后台管理项目，各种单据漫天飞，而且单据列表要可编辑，可验证，基于业务所以封装了"),a("a",{attrs:{href:"https://github.com/one-pupil/vue-template/blob/master/src/components/page-edit-table/index.vue",target:"_blank",rel:"noopener noreferrer"}},[s._v("可编辑表格组件"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("业务需求：")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("每列可以编辑")])]),s._v(" "),a("li",[a("p",[s._v("每列输入的值需要被验证")])])]),s._v(" "),a("p",[s._v("每列可编辑，则需要每列的字段需要一个可编辑的属性"),a("code",[s._v("edit")]),s._v("来确定是否可以编辑，输入的值可以被验证，需要我们传入验证规则。")]),s._v(" "),a("h3",{attrs:{id:"确认需要传入的props"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#确认需要传入的props"}},[s._v("#")]),s._v(" 确认需要传入的"),a("code",[s._v("props")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("props: {\n  // 表格数据\n  tableData: {\n    type: Array,\n    default: () => []\n  },\n  // 需要验证的列字段\n  columns: {\n    type: Array,\n    default: () => []\n  },\n  // 是否可编辑\n  defaultEdit: {\n    type: Boolean,\n    default: true\n  },\n  // 验证集合\n  verifyRules: {\n    type: Object,\n    default: () => {}\n  }\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("h3",{attrs:{id:"表格传入数据后-初始化可编辑状态"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#表格传入数据后-初始化可编辑状态"}},[s._v("#")]),s._v(" 表格传入数据后，初始化可编辑状态")]),s._v(" "),a("p",[s._v("阅读"),a("code",[s._v("el-table")]),s._v("源码，可以看到，表格组件拥有自己的"),a("code",[s._v("store")]),s._v("，一些需要通信的状态都是它来维护的，我们也可创建一个自有的"),a("a",{attrs:{href:"https://github.com/one-pupil/vue-template/blob/master/src/components/page-edit-table/table-store.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("table-store.js"),a("OutboundLink")],1),s._v("来维护编辑状态")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("// 初始化数据\nthis.store = new TableStore({\n  list: this.tableData,\n  columns: this.columns,\n  defaultEdit: this.defaultEdit\n});\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h3",{attrs:{id:"可编辑列edit-table-cell"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#可编辑列edit-table-cell"}},[s._v("#")]),s._v(" 可编辑列"),a("code",[s._v("edit-table-cell")])]),s._v(" "),a("p",[s._v("利用"),a("code",[s._v("slot")]),s._v("插槽来传递编辑状态和验证规则")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("<slot v-else :cellState=\"cellState\" :validateCell=\"validateCell\"></slot>\n...\ncomputed: {\n  isInput() {\n    return this.slotName === 'input';\n  },\n  rowState() {\n    const states = this.editTable.store.states;\n    const rowState = states.get(this.row);\n    return rowState;\n  },\n  cellState() {\n    const cellState = this.rowState.get(this.prop);\n    return cellState;\n  }\n},\nmethods: {\n  // 验证\n  validateCell(cb) {\n    this.editTable\n      .verifyTableCell(this.row, this.prop, this.cellState)\n      .then(errMsg => {\n        const valid = !errMsg;\n        typeof cb === 'function' && cb(valid);\n      });\n  }\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br")])]),a("h3",{attrs:{id:"使用组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用组件"}},[s._v("#")]),s._v(" 使用组件")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('// edit-table.vue\n\n<page-edit-table\n  ref="editTable"\n  v-model="tableData"\n  :columns="[\'categoryName\', \'name\', \'purchaseDate\']"\n  :default-edit="true"\n  :verify-rules="verifyRules"\n>\n  <el-table\n    ref="table"\n    v-loading="loading"\n    :data="tableData"\n    tooltip-effect="dark"\n    highlight-current-row\n    border\n    stripe\n    style="width: 100%"\n  >\n    <el-table-column align="center" label="序号" width="50">\n      <template slot-scope="scope">{{ scope.$index + 1 }}</template>\n    </el-table-column>\n    <el-table-column label="品目名称" prop="categoryName" show-overflow-tooltip>\n      <template slot-scope="{ row }">\n        <edit-table-cell :row="row" prop="categoryName">\n          <template slot-scope="{ cellState, validateCell }">\n            <el-select\n              v-if="cellState.edit"\n              v-model="row.categoryName"\n              clearable\n              placeholder="请选择品目"\n              @change="validateCell"\n            >\n              <el-option label="你" value="1"></el-option>\n              <el-option label="好" value="2"></el-option>\n              <el-option label="呀" value="3"></el-option>\n            </el-select>\n            <span v-if="!cellState.edit">{{ row.categoryName }}</span>\n          </template>\n        </edit-table-cell>\n      </template>\n    </el-table-column>\n....    \n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br")])]),a("p",[s._v("效果如下")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.ax1x.com/2019/12/08/QdSbCt.gif",alt:""}})]),s._v(" "),a("p",[s._v("具体代码可查看"),a("a",{attrs:{href:"https://github.com/one-pupil/vue-template/blob/master/src/components/page-edit-table/index.vue",target:"_blank",rel:"noopener noreferrer"}},[s._v("组件"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"增删改的树组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#增删改的树组件"}},[s._v("#")]),s._v(" 增删改的树组件")]),s._v(" "),a("p",[a("code",[s._v("el-tree")]),s._v("树形组件其实已经支持了"),a("strong",[s._v("自定义节点内容")]),s._v("，但是我们要在它的基础上改变"),a("strong",[s._v("节点内容")]),s._v("，这里主要是运用了"),a("code",[s._v("Vue.set")]),s._v("向响应式对象中添加一个属性。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("// 部分代码\nappend(node, data) {\n  const { label } = this.configProps;\n  const newChild = {\n    id: id++,\n    [label]: `三级-${id}`,\n    children: [],\n    isEdit: false\n  };\n  if (!data.children) {\n    this.$set(data, 'children', []);\n  }\n  data.children.push(newChild);\n  this.$emit('addNode', node, data);\n},\nedit(node, data) {\n  if (!node.isEdit) {\n    this.$set(node, 'isEdit', true);\n  }\n  this.$nextTick(() => {\n    this.$refs[`treeInput${node.id}`].focus();\n  });\n  this.$emit('editNode', node, data);\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])]),a("p",[s._v("效果如下：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.ax1x.com/2019/12/08/Qdp1xK.gif",alt:""}})]),s._v(" "),a("h2",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),a("p",[s._v("组件是项目的积木条，公用组件的封装成功与否其实是对项目的开发效率有直接影响。具体代码可查看"),a("a",{attrs:{href:"https://github.com/one-pupil/vue-template",target:"_blank",rel:"noopener noreferrer"}},[s._v("vue-template"),a("OutboundLink")],1),s._v("，基于"),a("code",[s._v("vue-cli3.0")]),s._v("搭建的后台模版。")]),s._v(" "),a("ul",[a("li",[a("RouterLink",{attrs:{to:"/Note/webpack/webpack.html"}},[s._v("webpack常规打包优化方案")])],1),s._v(" "),a("li",[a("RouterLink",{attrs:{to:"/Note/vue/props.html"}},[s._v("组件通信处理方案")])],1),s._v(" "),a("li",[a("RouterLink",{attrs:{to:"/Note/vue/http.html"}},[s._v("后台管理项目总结")])],1),s._v(" "),a("li",[a("RouterLink",{attrs:{to:"/Note/vue/deploy.html"}},[s._v("项目部署")])],1)]),s._v(" "),a("ul",[a("li",[s._v("参考\n"),a("a",{attrs:{href:"https://github.com/ElemeFE/element/blob/dev/packages/table/src/table.vue",target:"_blank",rel:"noopener noreferrer"}},[s._v("ElTable"),a("OutboundLink")],1),s._v(" "),a("a",{attrs:{href:"https://github.com/code-farmer-i/el-table-editabled",target:"_blank",rel:"noopener noreferrer"}},[s._v("el-table-editabled"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);e.default=n.exports}}]);