(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{230:function(s,n,t){"use strict";t.r(n);var a=t(0),e=Object(a.a)({},(function(){var s=this,n=s.$createElement,t=s._self._c||n;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"利用js-xlsx前端导出excel"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#利用js-xlsx前端导出excel"}},[s._v("#")]),s._v(" 利用js-xlsx前端导出Excel")]),s._v(" "),t("p",[s._v("由于项目临时加入导出Excel功能，后台童靴没有多余时间来处理，想前端来处理导出。")]),s._v(" "),t("p",[s._v("查询了前端导出方法，大部分是利用"),t("code",[s._v("js-xlsx")]),s._v("来做处理，按照"),t("a",{attrs:{href:"https://github.com/SheetJS/js-xlsx",target:"_blank",rel:"noopener noreferrer"}},[s._v("js-xlsx"),t("OutboundLink")],1),s._v("来导出"),t("code",[s._v("excel")]),s._v("时是没有样式处理的。需要我们来利用该库的专业版本才能设置样式。")]),s._v(" "),t("p",[s._v("这里就需要"),t("a",{attrs:{href:"https://github.com/protobi/js-xlsx/tree/beta",target:"_blank",rel:"noopener noreferrer"}},[s._v("xlsx-style"),t("OutboundLink")],1),s._v("来处理，给我们的"),t("code",[s._v("excel")]),s._v("文件来添加样式。")]),s._v(" "),t("h2",{attrs:{id:"利用数据导出"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#利用数据导出"}},[s._v("#")]),s._v(" 利用数据导出")]),s._v(" "),t("p",[s._v("拿到后端数据，先要对数据进行组装才能导出我们想要的文件格式。如果想文件有样式只能利用"),t("code",[s._v("xlsx-style")]),s._v(";")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("npm install xlsx-style\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("拷贝下载下来的文件目录"),t("code",[s._v("dist")]),s._v("里的"),t("code",[s._v("xlsx.core.min.js")]),s._v("，引入文件")]),s._v(" "),t("img",{attrs:{src:"_img/editor/code.png"}}),s._v(" "),t("p",[s._v("这里借鉴这位"),t("a",{attrs:{href:"https://www.jianshu.com/p/5cfe0ead22cd",target:"_blank",rel:"noopener noreferrer"}},[s._v("博主"),t("OutboundLink")],1),s._v("主要代码，整理了下，可以实现表头与导出文件名称。")]),s._v(" "),t("p",[s._v("具体调用可以"),t("a",{attrs:{href:"https://imondo.cn/excelj/",target:"_blank",rel:"noopener noreferrer"}},[s._v("查看DEMO"),t("OutboundLink")],1)]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("/**\n * @param {Array} header 表格头部\n * @param {Array} body 表格数据\n * @param {String} title 表格导出名称\n * @param {Boolean} hasTitle 是否需要表格标题\n */\nfunction ExportsEXCL() {\n  this.downLoad = ({\n    header = [],\n    body = [],\n    title = 'excel',\n    hasTitle = false,\n  }) => {\n    const styleCell = this.setBorderStyle();\n\n    const _headers = header\n      .map((v, i) => {\n        let key = Object.keys(v);\n        return Object.assign(\n          {},\n          {\n            v: `${v[key[0]]}<key>${key[0]}`,\n            position: String.fromCharCode(65 + i) + (hasTitle ? 1 : 0)\n          }\n        );\n      })\n      .reduce(\n        (prev, next) =>\n          Object.assign({}, prev, {\n            [next.position]: { v: next.v, s: styleCell }\n          }),\n        {}\n      );\n    const _body = body\n      .map((v, i) =>\n        header.map((k, j) => {\n          let key = Object.keys(k);\n          return Object.assign(\n            {},\n            {\n              v: v[key[0]],\n              position: String.fromCharCode(65 + j) + (i + (hasTitle ? 2 : 1))\n            }\n          );\n        })\n      )\n      .reduce((prev, next) => prev.concat(next))\n      .reduce(\n        (prev, next) =>\n          Object.assign({}, prev, {\n            [next.position]: { v: next.v, s: styleCell }\n          }),\n        {}\n      );\n\n    const mergeThead = this.setMergeThead(_headers, hasTitle, title);\n\n    const _merges = this.setTableMerges(header, _headers, hasTitle);\n\n    const _thead = this.setTableThead(mergeThead);\n\n    const output = Object.assign({}, _thead, _body);\n\n    const outputPos = Object.keys(output).sort();\n\n    const ref = outputPos[0] + ':' + outputPos[outputPos.length - 1];\n\n    const wb = {\n      SheetNames: ['mySheet'],\n      Sheets: {\n        mySheet: Object.assign({}, output, { '!ref': ref, '!merges': _merges })\n      }\n    };\n\n    this.save(wb, `${title}.xlsx`);\n  };\n\n  this.setTableThead = wb => {\n    for (let key in wb) {\n      let i = wb[key].v.indexOf('<key>');\n      if (wb[key].v.includes('<key>')) {\n        wb[key].v = wb[key].v.substr(0, i);\n      }\n    }\n    return wb;\n  };\n\n  // 设置合并表头\n  this.setTableMerges = (header, wb, hasTitle) => {\n    let _merges = [];\n    let len = header.length - 1;\n    if (hasTitle) {\n      let o = {\n        s: {\n          c: 0,\n          r: 0\n        },\n        e: {\n          c: len,\n          r: 0\n        }\n      };\n      _merges.push(o);\n    }\n    return [..._merges];\n  };\n\n  // 设置表头\n  this.setMergeThead = (wb, merge, hasTitle, title) => {\n    const borderAll = {\n      top: {\n        style: 'thin'\n      },\n      bottom: {\n        style: 'thin'\n      },\n      left: {\n        style: 'thin'\n      },\n      right: {\n        style: 'thin'\n      }\n    };\n    if (hasTitle) {\n      wb['A1'] = {\n        v: `${title}`,\n        s: {\n          border: borderAll,\n          font: {\n            sz: 18,\n            bold: true\n          },\n          alignment: {\n            horizontal: 'center'\n          }\n        }\n      };\n    }\n    return wb;\n  };\n\n  this.setBorderStyle = () => {\n    const borderAll = {\n      top: {\n        style: 'thin'\n      },\n      bottom: {\n        style: 'thin'\n      },\n      left: {\n        style: 'thin'\n      },\n      right: {\n        style: 'thin'\n      }\n    };\n    return { border: borderAll };\n  };\n\n  this.save = (wb, fileName) => {\n    let wopts = {\n      bookType: 'xlsx',\n      bookSST: false,\n      type: 'binary'\n    };\n    let xw = XLSX.write(wb, wopts);\n    let obj = new Blob([this.s2ab(xw)], {\n      type: ''\n    });\n    let elem = document.createElement('a');\n    elem.download = fileName || '下载';\n    elem.href = URL.createObjectURL(obj);\n    elem.click();\n    setTimeout(function() {\n      URL.revokeObjectURL(obj);\n    }, 100);\n  };\n\n  this.s2ab = s => {\n    if (typeof ArrayBuffer !== 'undefined') {\n      var buf = new ArrayBuffer(s.length);\n      var view = new Uint8Array(buf);\n      for (var i = 0; i != s.length; ++i) view[i] = s.charCodeAt(i) & 0xff;\n      return buf;\n    } else {\n      var buf = new Array(s.length);\n      for (var i = 0; i != s.length; ++i) buf[i] = s.charCodeAt(i) & 0xff;\n      return buf;\n    }\n  };\n\n  // 根据val查询Object key\n  this.findKey = (val, obj) => {\n    return Object.keys(obj).find(v => obj[v] === val);\n  };\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br"),t("span",{staticClass:"line-number"},[s._v("75")]),t("br"),t("span",{staticClass:"line-number"},[s._v("76")]),t("br"),t("span",{staticClass:"line-number"},[s._v("77")]),t("br"),t("span",{staticClass:"line-number"},[s._v("78")]),t("br"),t("span",{staticClass:"line-number"},[s._v("79")]),t("br"),t("span",{staticClass:"line-number"},[s._v("80")]),t("br"),t("span",{staticClass:"line-number"},[s._v("81")]),t("br"),t("span",{staticClass:"line-number"},[s._v("82")]),t("br"),t("span",{staticClass:"line-number"},[s._v("83")]),t("br"),t("span",{staticClass:"line-number"},[s._v("84")]),t("br"),t("span",{staticClass:"line-number"},[s._v("85")]),t("br"),t("span",{staticClass:"line-number"},[s._v("86")]),t("br"),t("span",{staticClass:"line-number"},[s._v("87")]),t("br"),t("span",{staticClass:"line-number"},[s._v("88")]),t("br"),t("span",{staticClass:"line-number"},[s._v("89")]),t("br"),t("span",{staticClass:"line-number"},[s._v("90")]),t("br"),t("span",{staticClass:"line-number"},[s._v("91")]),t("br"),t("span",{staticClass:"line-number"},[s._v("92")]),t("br"),t("span",{staticClass:"line-number"},[s._v("93")]),t("br"),t("span",{staticClass:"line-number"},[s._v("94")]),t("br"),t("span",{staticClass:"line-number"},[s._v("95")]),t("br"),t("span",{staticClass:"line-number"},[s._v("96")]),t("br"),t("span",{staticClass:"line-number"},[s._v("97")]),t("br"),t("span",{staticClass:"line-number"},[s._v("98")]),t("br"),t("span",{staticClass:"line-number"},[s._v("99")]),t("br"),t("span",{staticClass:"line-number"},[s._v("100")]),t("br"),t("span",{staticClass:"line-number"},[s._v("101")]),t("br"),t("span",{staticClass:"line-number"},[s._v("102")]),t("br"),t("span",{staticClass:"line-number"},[s._v("103")]),t("br"),t("span",{staticClass:"line-number"},[s._v("104")]),t("br"),t("span",{staticClass:"line-number"},[s._v("105")]),t("br"),t("span",{staticClass:"line-number"},[s._v("106")]),t("br"),t("span",{staticClass:"line-number"},[s._v("107")]),t("br"),t("span",{staticClass:"line-number"},[s._v("108")]),t("br"),t("span",{staticClass:"line-number"},[s._v("109")]),t("br"),t("span",{staticClass:"line-number"},[s._v("110")]),t("br"),t("span",{staticClass:"line-number"},[s._v("111")]),t("br"),t("span",{staticClass:"line-number"},[s._v("112")]),t("br"),t("span",{staticClass:"line-number"},[s._v("113")]),t("br"),t("span",{staticClass:"line-number"},[s._v("114")]),t("br"),t("span",{staticClass:"line-number"},[s._v("115")]),t("br"),t("span",{staticClass:"line-number"},[s._v("116")]),t("br"),t("span",{staticClass:"line-number"},[s._v("117")]),t("br"),t("span",{staticClass:"line-number"},[s._v("118")]),t("br"),t("span",{staticClass:"line-number"},[s._v("119")]),t("br"),t("span",{staticClass:"line-number"},[s._v("120")]),t("br"),t("span",{staticClass:"line-number"},[s._v("121")]),t("br"),t("span",{staticClass:"line-number"},[s._v("122")]),t("br"),t("span",{staticClass:"line-number"},[s._v("123")]),t("br"),t("span",{staticClass:"line-number"},[s._v("124")]),t("br"),t("span",{staticClass:"line-number"},[s._v("125")]),t("br"),t("span",{staticClass:"line-number"},[s._v("126")]),t("br"),t("span",{staticClass:"line-number"},[s._v("127")]),t("br"),t("span",{staticClass:"line-number"},[s._v("128")]),t("br"),t("span",{staticClass:"line-number"},[s._v("129")]),t("br"),t("span",{staticClass:"line-number"},[s._v("130")]),t("br"),t("span",{staticClass:"line-number"},[s._v("131")]),t("br"),t("span",{staticClass:"line-number"},[s._v("132")]),t("br"),t("span",{staticClass:"line-number"},[s._v("133")]),t("br"),t("span",{staticClass:"line-number"},[s._v("134")]),t("br"),t("span",{staticClass:"line-number"},[s._v("135")]),t("br"),t("span",{staticClass:"line-number"},[s._v("136")]),t("br"),t("span",{staticClass:"line-number"},[s._v("137")]),t("br"),t("span",{staticClass:"line-number"},[s._v("138")]),t("br"),t("span",{staticClass:"line-number"},[s._v("139")]),t("br"),t("span",{staticClass:"line-number"},[s._v("140")]),t("br"),t("span",{staticClass:"line-number"},[s._v("141")]),t("br"),t("span",{staticClass:"line-number"},[s._v("142")]),t("br"),t("span",{staticClass:"line-number"},[s._v("143")]),t("br"),t("span",{staticClass:"line-number"},[s._v("144")]),t("br"),t("span",{staticClass:"line-number"},[s._v("145")]),t("br"),t("span",{staticClass:"line-number"},[s._v("146")]),t("br"),t("span",{staticClass:"line-number"},[s._v("147")]),t("br"),t("span",{staticClass:"line-number"},[s._v("148")]),t("br"),t("span",{staticClass:"line-number"},[s._v("149")]),t("br"),t("span",{staticClass:"line-number"},[s._v("150")]),t("br"),t("span",{staticClass:"line-number"},[s._v("151")]),t("br"),t("span",{staticClass:"line-number"},[s._v("152")]),t("br"),t("span",{staticClass:"line-number"},[s._v("153")]),t("br"),t("span",{staticClass:"line-number"},[s._v("154")]),t("br"),t("span",{staticClass:"line-number"},[s._v("155")]),t("br"),t("span",{staticClass:"line-number"},[s._v("156")]),t("br"),t("span",{staticClass:"line-number"},[s._v("157")]),t("br"),t("span",{staticClass:"line-number"},[s._v("158")]),t("br"),t("span",{staticClass:"line-number"},[s._v("159")]),t("br"),t("span",{staticClass:"line-number"},[s._v("160")]),t("br"),t("span",{staticClass:"line-number"},[s._v("161")]),t("br"),t("span",{staticClass:"line-number"},[s._v("162")]),t("br"),t("span",{staticClass:"line-number"},[s._v("163")]),t("br"),t("span",{staticClass:"line-number"},[s._v("164")]),t("br"),t("span",{staticClass:"line-number"},[s._v("165")]),t("br"),t("span",{staticClass:"line-number"},[s._v("166")]),t("br"),t("span",{staticClass:"line-number"},[s._v("167")]),t("br"),t("span",{staticClass:"line-number"},[s._v("168")]),t("br"),t("span",{staticClass:"line-number"},[s._v("169")]),t("br"),t("span",{staticClass:"line-number"},[s._v("170")]),t("br"),t("span",{staticClass:"line-number"},[s._v("171")]),t("br"),t("span",{staticClass:"line-number"},[s._v("172")]),t("br"),t("span",{staticClass:"line-number"},[s._v("173")]),t("br"),t("span",{staticClass:"line-number"},[s._v("174")]),t("br"),t("span",{staticClass:"line-number"},[s._v("175")]),t("br"),t("span",{staticClass:"line-number"},[s._v("176")]),t("br"),t("span",{staticClass:"line-number"},[s._v("177")]),t("br"),t("span",{staticClass:"line-number"},[s._v("178")]),t("br"),t("span",{staticClass:"line-number"},[s._v("179")]),t("br"),t("span",{staticClass:"line-number"},[s._v("180")]),t("br"),t("span",{staticClass:"line-number"},[s._v("181")]),t("br"),t("span",{staticClass:"line-number"},[s._v("182")]),t("br"),t("span",{staticClass:"line-number"},[s._v("183")]),t("br"),t("span",{staticClass:"line-number"},[s._v("184")]),t("br"),t("span",{staticClass:"line-number"},[s._v("185")]),t("br"),t("span",{staticClass:"line-number"},[s._v("186")]),t("br"),t("span",{staticClass:"line-number"},[s._v("187")]),t("br"),t("span",{staticClass:"line-number"},[s._v("188")]),t("br"),t("span",{staticClass:"line-number"},[s._v("189")]),t("br"),t("span",{staticClass:"line-number"},[s._v("190")]),t("br"),t("span",{staticClass:"line-number"},[s._v("191")]),t("br"),t("span",{staticClass:"line-number"},[s._v("192")]),t("br"),t("span",{staticClass:"line-number"},[s._v("193")]),t("br"),t("span",{staticClass:"line-number"},[s._v("194")]),t("br"),t("span",{staticClass:"line-number"},[s._v("195")]),t("br"),t("span",{staticClass:"line-number"},[s._v("196")]),t("br")])]),t("h2",{attrs:{id:"利用dom导出"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#利用dom导出"}},[s._v("#")]),s._v(" 利用DOM导出")]),s._v(" "),t("p",[t("code",[s._v("js-xlsx")]),s._v("提供了一个直接导出HTML上的DOM表格方法"),t("code",[s._v("XLSX.utils.table_to_book")]),s._v("，但是导出的"),t("code",[s._v("excel")]),s._v("文件时没有任何样式，利用"),t("code",[s._v("xlsx-style")]),s._v("中的"),t("code",[s._v("xlsx.full.min.js")]),s._v("来导出时，没有上面这个方法，后面取了巧。")]),s._v(" "),t("p",[s._v("把"),t("code",[s._v("xlsx-style")]),s._v("中的"),t("code",[s._v("full")]),s._v("文件导出来的"),t("code",[s._v("XLSX")]),s._v("改成了"),t("code",[s._v("STYLEXLSX")]),s._v("；")]),s._v(" "),t("img",{attrs:{src:"_img/editor/carbon.png"}}),s._v(" "),t("p",[s._v("引用如下：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('<script src="//unpkg.com/xlsx/dist/shim.min.js"><\/script>\n<script src="//unpkg.com/blob.js@1.0.1/Blob.js"><\/script>\n<script src="//unpkg.com/file-saver@1.3.3/FileSaver.js"><\/script>\n<script src="./STYLEXLSX.full.min.js"><\/script>\n<script src="./xlsx.full.min.js"><\/script>\n\n<script src="./index.js"><\/script>\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("利用"),t("code",[s._v("js-xlsx")]),s._v("来导出表格数据，用"),t("code",[s._v("STYLEXLSX.write")]),s._v("来写入数据。")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("STYLEXLSX.write(\n  wb,\n  {\n    bookType: type == undefined ? 'xlsx' : type,\n    bookSST: false,\n    type: 'binary'\n  }\n)\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("具体主要代码：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("/**\n * \n * @param {Object} dom table的dom元素\n * @param {Object} name 导出的表名\n * @param {Object} type 导出的类型\n * \n */\nfunction exportExl(dom, name = '导出数据', type) {\n\tvar wb = XLSX.utils.table_to_book(dom, {sheet: \"Sheet JS\"});\n\tvar wopts = {\n    bookType: 'xlsx',\n    bookSST: true,\n    type: 'binary',\n    cellStyles: true\n\t};\n\n\tsetExlStyle(wb['Sheets']['Sheet JS']);\n\t\n\tlet tmpDown = new Blob(\n\t\t[\n\t\t\tthis.s2ab(\n\t\t\t\tSTYLEXLSX.write(\n\t\t\t\t\twb,\n\t\t\t\t\t{\n\t\t\t\t\t\tbookType: type == undefined ? 'xlsx' : type,\n\t\t\t\t\t\tbookSST: false,\n\t\t\t\t\t\ttype: 'binary'\n\t\t\t\t\t} //这里的数据是用来定义导出的格式类型\n\t\t\t\t)\n\t\t\t)\n\t\t],\n\t\t{\n\t\t\ttype: ''\n\t\t}\n\t);\n\tsaveAs(\n\t\ttmpDown,\n\t\t`${name}` +\n\t\t\t'.' +\n\t\t\t(wopts.bookType == 'biff2' ? 'xls' : wopts.bookType)\n\t);\t\n}\n\nfunction saveAs(obj, fileName) {\n\tlet tmpa = document.createElement('a');\n\ttmpa.download = fileName || '下载';\n\ttmpa.href = URL.createObjectURL(obj);\n\ttmpa.click();\n\tsetTimeout(function() {\n\t\tURL.revokeObjectURL(obj);\n\t}, 100);\n}\t\n\n\nfunction s2ab (s){\n\tif (typeof ArrayBuffer !== 'undefined') {\n\t\tvar buf = new ArrayBuffer(s.length);\n\t\tvar view = new Uint8Array(buf);\n\t\tfor (var i = 0; i != s.length; ++i) view[i] = s.charCodeAt(i) & 0xff;\n\t\treturn buf;\n\t} else {\n\t\tvar buf = new Array(s.length);\n\t\tfor (var i = 0; i != s.length; ++i) buf[i] = s.charCodeAt(i) & 0xff;\n\t\treturn buf;\n\t}\n};\n\nfunction setExlStyle (data) {  \n\t\n  let borderAll = {  //单元格外侧框线\n    top: {\n      style: 'thin'\n    },\n    bottom: {\n      style: 'thin'\n    },\n    left: {\n      style: 'thin'\n    },\n    right: {\n      style: 'thin'\n    }\n  }; \n\tdata['!cols'] = [];\n\tfor (let key in data) {\n\t\tif (data[key] instanceof Object) {\n\t\t\tdata[key].s = {\n\t\t\t\tborder: borderAll,\n\t\t\t\talignment: {\n\t\t\t\t\thorizontal: 'center'   //水平居中对其\n\t\t\t\t},\n\t\t\t\tnumFmt: 0\n\t\t\t}\n\t\t\tdata['!cols'].push({wpx: 170});\n\t\t}\n\t}\n\treturn data;\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br"),t("span",{staticClass:"line-number"},[s._v("75")]),t("br"),t("span",{staticClass:"line-number"},[s._v("76")]),t("br"),t("span",{staticClass:"line-number"},[s._v("77")]),t("br"),t("span",{staticClass:"line-number"},[s._v("78")]),t("br"),t("span",{staticClass:"line-number"},[s._v("79")]),t("br"),t("span",{staticClass:"line-number"},[s._v("80")]),t("br"),t("span",{staticClass:"line-number"},[s._v("81")]),t("br"),t("span",{staticClass:"line-number"},[s._v("82")]),t("br"),t("span",{staticClass:"line-number"},[s._v("83")]),t("br"),t("span",{staticClass:"line-number"},[s._v("84")]),t("br"),t("span",{staticClass:"line-number"},[s._v("85")]),t("br"),t("span",{staticClass:"line-number"},[s._v("86")]),t("br"),t("span",{staticClass:"line-number"},[s._v("87")]),t("br"),t("span",{staticClass:"line-number"},[s._v("88")]),t("br"),t("span",{staticClass:"line-number"},[s._v("89")]),t("br"),t("span",{staticClass:"line-number"},[s._v("90")]),t("br"),t("span",{staticClass:"line-number"},[s._v("91")]),t("br"),t("span",{staticClass:"line-number"},[s._v("92")]),t("br"),t("span",{staticClass:"line-number"},[s._v("93")]),t("br"),t("span",{staticClass:"line-number"},[s._v("94")]),t("br"),t("span",{staticClass:"line-number"},[s._v("95")]),t("br"),t("span",{staticClass:"line-number"},[s._v("96")]),t("br"),t("span",{staticClass:"line-number"},[s._v("97")]),t("br"),t("span",{staticClass:"line-number"},[s._v("98")]),t("br")])]),t("h2",{attrs:{id:"缺陷"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#缺陷"}},[s._v("#")]),s._v(" 缺陷")]),s._v(" "),t("p",[s._v("如果用数据来控制我们的导出，发现配置多级表头时会好复杂，所以没取深究了，用DOM来导出，又发现如果"),t("strong",[s._v("要导出分页表格")]),s._v("时只能导出当前页的数据。")]),s._v(" "),t("p",[s._v("而且现在所有的表格都可能不是规范的表格，每个表格结构可能都不相同，只能单独处理。")]),s._v(" "),t("p",[s._v("当前所有代码"),t("a",{attrs:{href:"https://github.com/one-pupil/study/tree/master/excel",target:"_blank",rel:"noopener noreferrer"}},[s._v("查看"),t("OutboundLink")],1)])])}),[],!1,null,null,null);n.default=e.exports}}]);